{
  "name": "request-enhanced",
  "version": "0.1.1",
  "author": {
    "name": "Joshua DeVinney",
    "email": "admin@geoffreak.com"
  },
  "description": "A layer on top of the request library to further abstract and simplify web requests",
  "main": "./lib/request-enhanced",
  "repository": {
    "type": "git",
    "url": "https://github.com/geoffreak/request-enhanced.git"
  },
  "keywords": [
    "request",
    "http",
    "get",
    "enhanced",
    "regex",
    "file"
  ],
  "dependencies": {
    "request": "2.12.0",
    "heap": "0.2.1"
  },
  "license": "MIT",
  "engines": {
    "node": ">=0.8"
  },
  "readme": "Request Enhanced\n================\n\nRequest Enhanced is a Node.js library that functions as a layer on top of the [request](https://github.com/mikeal/request) library to further abstract and simplify web requests. No worries about handling simple errors or retries, pooling requests, dealing with the complexity of writing to a file, or even manually searching the fetched content. Just fetch and done.\n\n\nNew Features\n------------\n\nIn addition to the awesome features that request offers, the following bonus features are available with request-enhanced\n\n* **Greater File Saving Simplicity** - No more worrying about odd edge cases or strange syntax when downloading to files. Directories are also automatically created along the specified file path as necessary.\n\n* **Request Pooling** - All requests are pooled to prevent EMFILE errors from too many simultaneous requests.\n\n* **Request Prioritizing** - Requests can be given a priority so that higher priority requests can execute first. \n\n* **Easy Searching of Results** - With regex queries, searching the resulting textual data becomes extremely simple.\n\n* **Automatic Retries** - When the connection fails with one of `ESOCKETTIMEDOUT`, `ETIMEDOUT`, `ECONNRESET` or `ECONNREFUSED` or when an HTTP 5xx error occurrs, the request will automatically be re-attempted as these are often recoverable errors and will go away on retry.\n\n\nInstalling\n----------\n\n```\nnpm install request-enhanced\n```\n\n\nBasic Usage\n-----------\n\nTo perform a simple GET request, the following code can be used:\n\n```javascript\nvar re = require('request-enhanced');\nre.get('http://www.example.com', function(error, data){\n  console.log('Fetched:', data);\n});\n```\n\n\nDon't want the result in memory and would rather pipe it to a file? No problem!\n\n```javascript\nre.get('http://www.example.com', '/path/to/resulting/file', function(error, filename){\n  console.log('Saved content to:', filename);\n});\n```\n\n\nFunction Documentation\n----------------------\n\n### The `get` Function\n\nThe `get` function actually has a bunch of optional parameters to achieve additional functionality. A detailed description of each of the parameters is below.\n\n```\nget ( options, [filename or regex], [priority], callback )\n```\n\n#### `options`\nThe options parameter behavior is nearly identical to request's options paramter. It is possible to pass a string URL of the target or any of [request's parameters](https://github.com/mikeal/request#requestoptions-callback) in an options object with the following additional options:\n\n* `maxAttempts` - The maximum number of attempts to retry the request, defaults to `10`\n* `retryDelay` - The delay in milliseconds before trying again after a recoverable failure, defaults to `5000`\n* `defaultValue` - The default value to assign to regex queries that find no data, defaults to `''`\n\nThe following options already existing in request now have default values:\n\n* `timeout` - Now defaults to `10000`\n* `pool` - Now defaults to `{maxSockets: Infinity}`\n\n#### `filename`\nThe filename is an optional string representing a location on disk where the results of the GET request should be written to. Any directories in the path not currently existing will be created automatically. *This option cannot be used at the same time as `regex`.*\n\n#### `regex`\nTo perform regular expression searches on the returned data, an optional regex query object can be provided. Regex queries are explained in the \"Regex Queries\" section below. *This option cannot be used at the same time as `filename`.*\n\n#### `priority`\nThe priority is an optional number representing the request's priority. Requests with a lesser value will be performed prior to those with a higher valued priority. Requests with the same priority will be performed in a [FIFO order](http://en.wikipedia.org/wiki/FIFO). If not specified, a request is given the default priority of `0`.\n\n#### `callback`\nThe callback function will be called on success or error due to unrecoverable error or reaching the maximum retries. The following parameters will be passed back to this function in the following order:\n\n* `error` - This will either be an error object if there was an error, or `null` if there was not. The error object may have a `code` paramter for an HTTP status code if the error was HTTP related.\n* `data` - If a filename was specified in the call, a string filename will be returned of the newly saved file on disk. If a filename was not specified in the call, the string data returned from the GET request will be returned.\n* `results` - If regex queries were specified in the call and a filename was not, the results of the queries running on the `data` will be returned in this object\n\n\n### The `setDefaults` Function\nThe `setDefaults` function allows for setting of the default values across all requests. A detailed description of each of the parameter it takes is below.\n\n```\nsetDefaults ( newDefaults ) \n```\n\n#### `newDefaults`\nThe newDefaults object contains a mapping of keys with their defaults. Only the defaults that are specified will be overridden. All others will remain as they were previously and any additional non-existant defaults specified will be ignored. \n\nHere is a list of the defaults that can be overridden:\n\n```javascript\ndefaults = {\n  maxAttempts: 10, // The default maximum number of retries before a request is deemed a failure\n  priority: 0, // The default priority a request is given if not specified\n  timeout: 10000, // The default delay in milliseconds before a request is automatically aborted and retried\n  retryDelay: 5000, // The default delay in milliseconds before a request is attempted again after a recoverable failure\n  defaultValue: '', // The default value to give a regex query if nothing is found\n  pool: { // request's default pool parameter\n    maxSockets: Infinity // request's max sockets is set to Infinity to allow request-enhanced to control pooling\n  },\n  maxConcurrent: 100 // The maximum number of concurrent requests\n};\n```\n\nRegex Queries\n-------------\nRegex queries are a much simpler way to deal with searching in the returned content. When a regex query object is present in a call to the `get` function, the fetched data will be automatically parsed.\n\n### Basic Regex Query\nHere is a very simple regex query:\n\n```javascript\n{\n  query: {\n    regex: /My query: \"(.*?)\"/i,\n    results: 1\n  }\n}\n```\n\nWhat this means is that the fetched data will be searched for the regex and then the first result of the match will be assigned to the `query` key of the `results` object returned. \n\nAs an example, if using the regex query above and the fetched data contained `my query: \"hello world\"`, the results object would look like this:\n\n```javascript\n{\n  query: \"hello world\"\n}\n```\n\n### String Regular Expressions\nInstead of supplying a native RegExp object, it is also possible to supply a string as the regex.\n\n```javascript\n{\n  query: {\n    regex: 'My query: \"(.*?)\"',\n    results: 1\n  }\n}\n```\n\nBy default, only the case insensitive flag `i` will be set automatically, but it is possible to set or disable any of the three flags.\n\n```javascript\n{\n  query: {\n    regex: 'My query: \"(.*?)\"',\n    results: 1,\n    caseSensitive: true, // disables the i flag\n    multiple: true,      // enables the g flag\n    multiline: true      // enables the m flag\n  }\n}\n```\n\nThe values of these parameters need not be the boolean `true`, but anything that equates to true.\n\n### Multiple Matches\nBy default, a regex query will return only the first match, but it is possible to return the results of every match by setting the global flag `g` in the RegExp object or by using the `multiple: true` setting. Instead of returning the value of the result directly as the value of the key as in the basic example, the value will be an array of matches.\n\nTake for example, the following regex query:\n\n```javascript\n{\n  query: {\n    regex: /My query: \"(.*?)\"/gi,\n    results: 1\n  }\n}\n```\n\nIf the fetched data contained both `my query: \"hello world\"` and `my query: \"goodbye world\"`, the results object would look like this:\n\n```javascript\n{\n  query: [\"hello world\", \"goodbye world\"]\n}\n```\n\n*Note: An array will always be returned for multiple matches queries. Simply use `array.length` to determine the number of matches found.*\n\n### Multiple Results\nIt is also possible to return multiple results from a single query. Simply supply a mapping of result indexes to keys to store the resulting data on in place of the numerical index from the above examples. The results object will assign the matches to the keys and return the new mapping as the result.\n\nThis query will return multiple results:\n\n```javascript\n{\n  query: {\n    regex: /My query: \"(.*?)\", ~(.*?)~/i,\n    results: {\n      1: 'myquery',\n      2: 'tilde'\n    }\n  }\n}\n```\n\nIf the fetched data contained `my query: \"hello world\", ~hello!~`, the results object would look like this:\n\n```javascript\n{\n  query: {\n    myquery: 'hello world',\n    tilde: 'hello!'\n  }\n}\n```\n\nMultiple results can be returned from multiple matches as well. By tweaking the example query above to add a global flag `g` and also finding `my query: \"goodbye world\", ~goodbye!~` in the fetched data, the results object would be changed to this:\n\n```javascript\n{\n  query: [\n    {\n      myquery: 'hello world',\n      tilde: 'hello!'\n    }, \n    {\n      myquery: 'goodbye world',\n      tilde: 'goodbye!'\n    }\n  ]\n}\n```\n\n### Multiple Queries\nFinally, it is also possible to do as many queries as desired on the fetched data. Simply supply more keys mapping to regex queries.\n\nUse this type of query:\n\n```javascript\n{\n  queryOne: { ... },\n  queryTwo: { ... },\n  queryThree: { ... },\n}\n```\n\nto produce this type of results object:\n\n```javascript\n{\n  queryOne: ... ,\n  queryTwo: ... ,\n  queryThree: ... ,\n}\n```\n\n### Tips and Tricks\n1. **Important to note!** The `.` character in JavaScript flavored regular expressions *doesn't* match line breaks by default. It is neccessary to set the multiline flag `m` in the RegExp object, or use `multiline: true` for a string regular expression if this functionality is desired.\n2. The index of the first match in a regex query is not 0, but 1. The entire matched string is at index 0 thanks to JavaScript's `String.match()` function. Requesting an index of 0 will return the entire matched string (e.g. `my query: \"hello world\"`).\n3. When unsure about the indexes of the results of the regex query, simply remove the `results:` declaration (or set to null). The `String.match()` results as described in #2 will all be returned in an array. An empty array will be returned in cases where nothing is found.\n",
  "readmeFilename": "readme.md",
  "_id": "request-enhanced@0.1.1",
  "dist": {
    "shasum": "60be9573cf3112c9853ea36b9add709ec4337dae",
    "tarball": "http://registry.npmjs.org/request-enhanced/-/request-enhanced-0.1.1.tgz"
  },
  "_npmVersion": "1.1.65",
  "_npmUser": {
    "name": "geoffreak",
    "email": "admin@geoffreak.com"
  },
  "maintainers": [
    {
      "name": "geoffreak",
      "email": "admin@geoffreak.com"
    }
  ],
  "directories": {},
  "_shasum": "60be9573cf3112c9853ea36b9add709ec4337dae",
  "_from": "request-enhanced@",
  "_resolved": "https://registry.npmjs.org/request-enhanced/-/request-enhanced-0.1.1.tgz"
}
